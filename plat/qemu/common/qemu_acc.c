#include <assert.h>
#include <string.h>

#include <plat/common/platform.h>
#include <platform_def.h>

static unsigned char device_cert_der[] = \
    "\x30\x82\x01\x4d\x30\x81\xfb\x02\x09\x00\xc3\x33\x55\xd3\xb5\xfb\x59\xca\x30\x0a" \
    "\x06\x08\x2a\x86\x48\xce\x3d\x04\x03\x02\x30\x38\x31\x0b\x30\x09\x06\x03\x55\x04" \
    "\x06\x13\x02\x50\x54\x31\x0b\x30\x09\x06\x03\x55\x04\x08\x0c\x02\x50\x54\x31\x0b" \
    "\x30\x09\x06\x03\x55\x04\x0a\x0c\x02\x55\x4d\x31\x0f\x30\x0d\x06\x03\x55\x04\x0b" \
    "\x0c\x06\x48\x61\x73\x6c\x61\x62\x30\x1e\x17\x0d\x32\x30\x30\x34\x31\x31\x31\x30" \
    "\x32\x37\x30\x32\x5a\x17\x0d\x32\x31\x30\x34\x31\x31\x31\x30\x32\x37\x30\x32\x5a" \
    "\x30\x38\x31\x0b\x30\x09\x06\x03\x55\x04\x06\x13\x02\x50\x54\x31\x0b\x30\x09\x06" \
    "\x03\x55\x04\x08\x0c\x02\x50\x54\x31\x0b\x30\x09\x06\x03\x55\x04\x0a\x0c\x02\x55" \
    "\x4d\x31\x0f\x30\x0d\x06\x03\x55\x04\x0b\x0c\x06\x48\x61\x73\x6c\x61\x62\x30\x4e" \
    "\x30\x10\x06\x07\x2a\x86\x48\xce\x3d\x02\x01\x06\x05\x2b\x81\x04\x00\x21\x03\x3a" \
    "\x00\x04\x7e\x82\xec\x7c\x5a\x6f\x3a\xaf\x7f\x57\x2a\xf6\xfc\xdc\xf8\x53\xac\xc0" \
    "\x12\x2c\xe6\x82\x78\x17\x17\xfe\x46\xde\x52\x87\xc8\xa5\xd9\x91\x92\xf3\x70\x73" \
    "\x4f\x05\x54\xdd\xf5\xc5\x3a\x6e\xf3\xfc\xe4\x58\xfd\xc7\xea\xcc\x14\x57\x30\x0a" \
    "\x06\x08\x2a\x86\x48\xce\x3d\x04\x03\x02\x03\x41\x00\x30\x3e\x02\x1d\x00\x9f\xa8" \
    "\x27\x66\xcc\x1f\xb2\xc6\xd2\xe5\x36\x6d\xf3\x20\xb4\xe6\xab\xe8\xa5\xd3\x44\xfb" \
    "\x62\xf0\x26\x61\xee\xea\x02\x1d\x00\xde\x88\x51\xd2\x5a\xce\xb2\x9b\x38\x4e\x92" \
    "\x64\xfa\x9a\xd5\xe2\x38\xd5\xe9\xa3\x92\x03\xe5\x3e\x4c\x4d\x4b\x15";

/* 
 * Return the device certificate, used for attestation, in DER format
 */
int plat_get_device_cert(void **cert_ptr, unsigned int *cert_len){
    assert(cert_ptr != NULL);
    assert(cert_len != NULL);

	*cert_len = sizeof(device_cert_der);
    *cert_ptr = (void *)device_cert_der;

    return 0;
}

/* TODO
 * Update the device certificate used for attestation
 */
int plat_update_device_cert(void *hwkey, void *new_cert, unsigned int *cert_len){
    //Not implemented
    return 0;
}
